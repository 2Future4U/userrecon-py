#!/usr/bin/env python3

from argparse import ArgumentParser
import asyncio
import sys

try:
    from os import path

    sys.path.insert(0, path.abspath(path.join(path.dirname(__file__), "..")))
    from userrecon.version import __version__
    from userrecon import core

except ModuleNotFoundError as error:
    print("[-] error: {}".format(error))
    sys.exit(1)


def main(args):
    core.print_sexy_banner()
    username = args.username
    loop = asyncio.get_event_loop()
    loop.run_until_complete(core.verify_username(username))

    if args.output:
        filename = args.output
        core.generate_json_file(filename)


if __name__ == "__main__":

    # set arguments
    ap = ArgumentParser()
    ap.add_argument(
        "--target",
        metavar=("username"),
        dest="username",
        type=str,
        help="set username target.",
    )
    ap.add_argument(
        "-o", metavar=("filename"), dest="output", help="save output in JSON format."
    )
    ap.add_argument(
        "--version", "-v", action="version", version="%(prog)s " + __version__
    )
    args = ap.parse_args()
    main(args)

